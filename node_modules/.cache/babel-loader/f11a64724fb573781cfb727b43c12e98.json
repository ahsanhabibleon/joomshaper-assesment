{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _slicedToArray from\"/Users/ahsan/Documents/Ahsan/projects/react-photo-gallery-with-photo-filter/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useRef,useState,useEffect,useCallback}from'react';import PotoSettings from'./PhotoSettings';import{useDrag,useDrop}from'react-dnd';import{ItemCard}from'../../../itemTypes';import{useDispatch}from'react-redux';import{removePhotoFromCanvas}from'../../../redux/actions/addNewPhotoToCanvasActions';import'./CanvasImgCard.scss';var CanvasImgCard=function CanvasImgCard(_ref){var id=_ref.id,imgSrc=_ref.imgSrc,filterSettings=_ref.filterSettings,imgIndex=_ref.imgIndex,index=_ref.index,moveCard=_ref.moveCard;var dispatch=useDispatch();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),modalOpen=_useState2[0],setModalOpen=_useState2[1];var ref=useRef(null);useEffect(function(){onToggleForbidDrag();},[modalOpen]);var _useDrop=useDrop({accept:ItemCard.CARD,hover:function hover(item,monitor){var _ref$current;if(!ref.current){return;}var dragIndex=item.index;var hoverIndex=index;if(dragIndex===hoverIndex){return;}var hoverBoundingRect=(_ref$current=ref.current)===null||_ref$current===void 0?void 0:_ref$current.getBoundingClientRect();var hoverMiddleY=(hoverBoundingRect.bottom-hoverBoundingRect.top)/2;var clientOffset=monitor.getClientOffset();var hoverClientY=clientOffset.y-hoverBoundingRect.top;if(dragIndex<hoverIndex&&hoverClientY<hoverMiddleY){return;}if(dragIndex>hoverIndex&&hoverClientY>hoverMiddleY){return;}moveCard(dragIndex,hoverIndex);item.index=hoverIndex;}}),_useDrop2=_slicedToArray(_useDrop,2),drop=_useDrop2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),forbidDrag=_useState4[0],setForbidDrag=_useState4[1];var _useDrag=useDrag({item:{type:ItemCard.CARD,id:id,index:index},canDrag:!forbidDrag,end:function end(item,monitor){var dropResult=monitor.getDropResult();if(item&&dropResult){localStorage.setItem(\"monitor\",JSON.stringify(monitor));}},collect:function collect(monitor){return{isDragging:monitor.isDragging()};}}),_useDrag2=_slicedToArray(_useDrag,2),isDragging=_useDrag2[0].isDragging,drag=_useDrag2[1];drag(drop(ref));var deletePhoto=function deletePhoto(id){if(window.confirm(\"Do you realy want to delete this photo?\")){dispatch(removePhotoFromCanvas(id));}};var openPhotoSettings=function openPhotoSettings(){setModalOpen(!modalOpen);};var setModalStatus=function setModalStatus(payload){setModalOpen(payload);};var onToggleForbidDrag=useCallback(function(){!modalOpen?setForbidDrag(false):setForbidDrag(true);},[modalOpen]);return/*#__PURE__*/_jsx(\"div\",{className:\"canvasImgCard\"+(modalOpen?' modalOpen':''),children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{ref:ref,className:'canvasImgCard__draggableImg'+(isDragging?' isActive':''),id:imgIndex,children:/*#__PURE__*/_jsx(\"img\",{style:{filter:\"brightness(\".concat(filterSettings.brightness,\") contrast(\").concat(filterSettings.contrast,\"%) invert(\").concat(filterSettings.invert,\"%) grayscale(\").concat(filterSettings.grayscale,\"%)\")},src:imgSrc,alt:\"...\",width:\"278\",height:\"400\",\"data-id\":imgIndex})}),/*#__PURE__*/_jsxs(\"div\",{className:\"canvasImgCard__btnContainer\"+(modalOpen?' isActive':''),children:[/*#__PURE__*/_jsx(\"button\",{className:\"canvasImgCard__btnSettings\",onClick:openPhotoSettings,children:/*#__PURE__*/_jsx(\"img\",{src:\"/img/settings.svg\",alt:\"\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"canvasImgCard__btnSettings\"+(modalOpen?' disabled':''),onClick:function onClick(){return deletePhoto(id);},children:/*#__PURE__*/_jsx(\"img\",{src:\"/img/delete.svg\",alt:\"\"})})]}),modalOpen&&/*#__PURE__*/_jsx(PotoSettings,{imgSrc:imgSrc,isModalOpen:modalOpen,getModalStatus:setModalStatus,imgIndex:imgIndex})]})});};export default CanvasImgCard;","map":{"version":3,"sources":["/Users/ahsan/Documents/Ahsan/projects/react-photo-gallery-with-photo-filter/src/components/Global/PhotoContainer/CanvasImgCard.js"],"names":["React","useRef","useState","useEffect","useCallback","PotoSettings","useDrag","useDrop","ItemCard","useDispatch","removePhotoFromCanvas","CanvasImgCard","id","imgSrc","filterSettings","imgIndex","index","moveCard","dispatch","modalOpen","setModalOpen","ref","onToggleForbidDrag","accept","CARD","hover","item","monitor","current","dragIndex","hoverIndex","hoverBoundingRect","getBoundingClientRect","hoverMiddleY","bottom","top","clientOffset","getClientOffset","hoverClientY","y","drop","forbidDrag","setForbidDrag","type","canDrag","end","dropResult","getDropResult","localStorage","setItem","JSON","stringify","collect","isDragging","drag","deletePhoto","window","confirm","openPhotoSettings","setModalStatus","payload","filter","brightness","contrast","invert","grayscale"],"mappings":"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","sourcesContent":["import React, { useRef, useState, useEffect, useCallback } from 'react';\nimport PotoSettings from './PhotoSettings'\nimport { useDrag, useDrop } from 'react-dnd';\nimport { ItemCard } from '../../../itemTypes';\nimport { useDispatch } from 'react-redux'\nimport { removePhotoFromCanvas } from '../../../redux/actions/addNewPhotoToCanvasActions'\nimport './CanvasImgCard.scss'\n\nconst CanvasImgCard = ({ id, imgSrc, filterSettings, imgIndex, index, moveCard }) => {\n    const dispatch = useDispatch()\n    const [modalOpen, setModalOpen] = useState(false)\n    const ref = useRef(null);\n\n    useEffect(() => {\n        onToggleForbidDrag()\n    }, [modalOpen])\n\n    const [, drop] = useDrop({\n        accept: ItemCard.CARD,\n        hover(item, monitor) {\n            if (!ref.current) {\n                return;\n            }\n            const dragIndex = item.index;\n            const hoverIndex = index;\n            if (dragIndex === hoverIndex) {\n                return;\n            }\n            const hoverBoundingRect = ref.current?.getBoundingClientRect();\n            const hoverMiddleY = (hoverBoundingRect.bottom - hoverBoundingRect.top) / 2;\n            const clientOffset = monitor.getClientOffset();\n            const hoverClientY = clientOffset.y - hoverBoundingRect.top;\n            if (dragIndex < hoverIndex && hoverClientY < hoverMiddleY) {\n                return;\n            }\n            if (dragIndex > hoverIndex && hoverClientY > hoverMiddleY) {\n                return;\n            }\n            moveCard(dragIndex, hoverIndex);\n            item.index = hoverIndex;\n        },\n    });\n    const [forbidDrag, setForbidDrag] = useState(false);\n    const [{ isDragging }, drag] = useDrag({\n        item: { type: ItemCard.CARD, id, index },\n        canDrag: !forbidDrag,\n        end: (item, monitor) => {\n            const dropResult = monitor.getDropResult();\n            if (item && dropResult) {\n                localStorage.setItem(\"monitor\", JSON.stringify(monitor))\n            }\n        },\n        collect: (monitor) => ({\n            isDragging: monitor.isDragging(),\n        }),\n    });\n\n    drag(drop(ref));\n\n    const deletePhoto = (id) => {\n        if (window.confirm(\"Do you realy want to delete this photo?\")) {\n            dispatch(removePhotoFromCanvas(id))\n        }\n    }\n    const openPhotoSettings = () => {\n        setModalOpen(!modalOpen)\n    }\n    const setModalStatus = (payload) => {\n        setModalOpen(payload)\n    }\n    const onToggleForbidDrag = useCallback(() => {\n        !modalOpen ? setForbidDrag(false) : setForbidDrag(true)\n    }, [modalOpen]);\n\n    return (\n        <div className={\"canvasImgCard\" + (modalOpen ? ' modalOpen' : '')}>\n            <div>\n                <div ref={ref} className={'canvasImgCard__draggableImg' + (isDragging ? ' isActive' : '')} id={imgIndex}>\n                    <img style={{ filter: `brightness(${filterSettings.brightness}) contrast(${filterSettings.contrast}%) invert(${filterSettings.invert}%) grayscale(${filterSettings.grayscale}%)` }} src={imgSrc} alt=\"...\" width=\"278\" height=\"400\" data-id={imgIndex} />\n                </div>\n\n                <div className={\"canvasImgCard__btnContainer\" + (modalOpen ? ' isActive' : '')}>\n                    <button className=\"canvasImgCard__btnSettings\" onClick={openPhotoSettings}>\n                        <img src=\"/img/settings.svg\" alt=\"\" />\n                    </button>\n                    <button className={\"canvasImgCard__btnSettings\" + (modalOpen ? ' disabled' : '')} onClick={() => deletePhoto(id)}>\n                        <img src=\"/img/delete.svg\" alt=\"\" />\n                    </button>\n                </div>\n                {\n                    modalOpen && <PotoSettings imgSrc={imgSrc} isModalOpen={modalOpen} getModalStatus={setModalStatus} imgIndex={imgIndex} />\n                }\n            </div>\n        </div>\n    );\n};\n\nexport default CanvasImgCard\n"]},"metadata":{},"sourceType":"module"}